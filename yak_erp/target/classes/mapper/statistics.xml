<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="statistics">
	<!-- id 속성은 DAO 의 메소드와 같아야 한다. 여기의 boardVO 는 mybatis-confg.xml 에 Alias 되어 
		있습니다. -->
	
<select id="gettoday" resultType="com.km.yak_erp.vo.Statistics">
        <![CDATA[
           select 
 				count(*) as "visit_total" 
 		   from visitor
 		   where visit_timee >to_char(sysdate-1,'YYYY-MM-DD HH24:MI:SS')
 				and visit_timee <= to_char(sysdate,'YYYY-MM-DD HH24:MI:SS')
      ]]> 
    </select>
    
    <select id="total" resultType="int">
        <![CDATA[
           select 
 				sum(price) as "banner_total"
 		   from banner
      ]]> 
    </select>
    
    
    <select id="getbanner_monthly" resultType="int">
        <![CDATA[
            select 	count(*) as "banner_monthly"
 		   from banner
 		   where TO_CHAR(ban_start,'MM/DD') >= TO_CHAR(TRUNC(SYSDATE,'MM'),'MM/DD')
      ]]> 
    </select>
    
    <select id="banner_monthly_total" resultType="int">
        <![CDATA[
            select 	sum(price) as "banner_monthly_total"
 		   from banner
 		   where TO_CHAR(ban_start,'MM/DD') >= TO_CHAR(TRUNC(SYSDATE,'MM'),'MM/DD')
      ]]> 
    </select>
    
    
    <select id="getlive" resultType="com.km.yak_erp.vo.Statistics">
        <![CDATA[
           select 
           today as "visit_today"
 		   from today_visitor
      ]]> 
    </select>
    
    
    <select id="getweek" resultType="com.km.yak_erp.vo.Statistics">
        <![CDATA[
          select visit_timee, count(*) as "visit_count"
 			from visitor 
 			where 
 			visit_timee BETWEEN TO_CHAR(SYSDATE - (TO_CHAR(SYSDATE, 'D') - 1) - 6, 'YYYY-MM-DD') 
 			AND TO_CHAR(SYSDATE - (TO_CHAR(SYSDATE, 'D') - 1), 'YYYY-MM-DD')
 			group by visit_timee
 			order by visit_timee asc
      ]]> 
    </select>

</mapper>